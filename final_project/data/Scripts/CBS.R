library("DNAcopy")
cn <- read.table("varScan.copynumber.called",header=T)
pos <- round((cn[,2]+cn[,3])/2)
CNA.object <-CNA( genomdat = cn$adjusted_log_ratio, chrom = cn[,1], maploc = pos, data.type = 'logratio', sampleid=c("$sampleName"), presorted=TRUE)
CNA.smoothed <- smooth.CNA(CNA.object)
segs <- segment(CNA.smoothed, verbose=0, min.width=2)
out=segments.p(segs)
write.table(out, file="varScan.copynumber.called.seg", row.names=F, col.names=T, quote=F, sep="\t")

png("varScan.copynumber.called.seg.w.png", width=960, height=960)
plot(segs, plot.type="w")
dev.off()
png("varScan.copynumber.called.seg.s.png", width=960, height=960)
plot(segs, plot.type="s")
dev.off()
png("varScan.copynumber.called.seg.p.png", width=960, height=960)
plot(segs, plot.type="p")
dev.off()
